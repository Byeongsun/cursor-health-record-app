---
globs: *.ts,*.tsx
description: TypeScript and Code Style Guidelines
---

# ğŸ“ TypeScript & Code Style Guidelines

## âš™ï¸ TypeScript Configuration
- **Target**: ES2022
- **Strict Mode**: Always enabled
- **JSX**: React JSX transform
- **Module Resolution**: Bundler mode

## ğŸ“¦ Import Order & Syntax
1. **React imports** (React, hooks, etc.)
2. **Third-party libraries** (MUI, Redux, etc.)
3. **Internal components and utilities**
4. **Type imports** (with `type` keyword)

```typescript
// âœ… Correct import order
import React, { useState, useEffect } from 'react'
import { Container, Typography, Button } from '@mui/material'
import { useDispatch, useSelector } from 'react-redux'
import { useAuth } from '../hooks/useAuth'
import type { PayloadAction } from '@reduxjs/toolkit'
```

### Import Completeness & Error Prevention
- **ALWAYS import all used components, functions, and types**
- **Verify imports before using any component or function**
- **Use consistent naming conventions for imports**
- **NEVER use undefined variables or components**

```typescript
// âœ… Complete imports
import { 
  Container, 
  Typography, 
  Button, 
  IconButton,  // â† Don't forget IconButton!
  ArrowBack as ArrowBackIcon  // â† Don't forget icons!
} from '@mui/material'

// âŒ Missing imports will cause runtime errors
<IconButton>  // â† Error: IconButton is not defined
<ArrowBackIcon />  // â† Error: ArrowBackIcon is not defined
```

### Material-UI Icon Import Checklist
**Before using any MUI icon, ensure it's imported:**

```typescript
// âœ… Always import icons from @mui/icons-material
import {
  ArrowBack as ArrowBackIcon,
  ArrowForward as ArrowForwardIcon,
  Home as HomeIcon,
  Settings as SettingsIcon,
  Notifications as NotificationsIcon,
  Person as PersonIcon,
  ExitToApp as LogoutIcon,
  Add as AddIcon,
  Edit as EditIcon,
  Delete as DeleteIcon,
  Search as SearchIcon,
  FilterList as FilterIcon,
  Download as DownloadIcon,
  Upload as UploadIcon,
  Refresh as RefreshIcon,
  Flag as FlagIcon,
  Timeline as TimelineIcon,
  BarChart as BarChartIcon,
  TableChart as TableIcon,
  PieChart as PieChartIcon,
  MonitorHeart as MonitorHeartIcon,
  Bloodtype as BloodtypeIcon,
  Scale as ScaleIcon,
  List as ListIcon,
  CloudUpload as UploadIcon,
  CloudDownload as DownloadIcon,
} from '@mui/icons-material'
```

### Common Import Errors to Avoid
1. **IconButton is not defined** â†’ Add `IconButton` to MUI imports
2. **ArrowBackIcon is not defined** â†’ Add `ArrowBack as ArrowBackIcon` to icon imports
3. **DeleteIcon is not defined** â†’ Add `Delete as DeleteIcon` to icon imports
4. **EditIcon is not defined** â†’ Add `Edit as EditIcon` to icon imports
5. **Any MUI component is not defined** â†’ Check MUI imports section

### Type Import Rules
```typescript
// âœ… ALWAYS use 'type' keyword for type-only imports
import type { AppDispatch, RootState } from '../store'
import type { PayloadAction } from '@reduxjs/toolkit'
import type { HealthRecord } from '../store/slices/healthRecordsSlice'

// âŒ NEVER import types without 'type' keyword
import { AppDispatch } from '../store'  // This will cause runtime errors!
import { PayloadAction } from '@reduxjs/toolkit'  // This will cause runtime errors!

// âœ… For mixed imports (values + types), separate them
import { useDispatch, useSelector } from 'react-redux'
import type { AppDispatch, RootState } from '../store'
```

## ğŸ·ï¸ Type Definitions

### Interface vs Type
```typescript
// âœ… Use interface for object shapes
interface UserProfile {
  id: string
  email: string
  name: string
  birth_year?: number
  gender?: string
}

// âœ… Use type for unions and primitives
type RecordType = 'blood_pressure' | 'blood_sugar' | 'weight'
type HealthStatus = 'normal' | 'warning' | 'danger'
```

### Component Props
```typescript
// âœ… Always use explicit types for props
interface ComponentProps {
  title: string
  isVisible?: boolean
  onAction: (id: string) => void
}

const ComponentName: React.FC<ComponentProps> = ({ 
  title, 
  isVisible = false, 
  onAction 
}) => {
  // Component implementation
}
```

## ğŸ”„ Redux Patterns

### Async Thunks
```typescript
// âœ… Use createAsyncThunk for async actions
export const fetchHealthRecords = createAsyncThunk(
  'healthRecords/fetchHealthRecords',
  async (userId: string) => {
    const { data, error } = await supabase
      .from('health_records')
      .select('*')
      .eq('user_id', userId)
    
    if (error) throw error
    return data
  }
)
```

### Redux Type Imports
```typescript
// âœ… ALWAYS use type imports for Redux types
import type { PayloadAction } from '@reduxjs/toolkit'
import type { RootState, AppDispatch } from '../store'

// âœ… Component with Redux types
const MyComponent: React.FC = () => {
  const dispatch = useDispatch<AppDispatch>()  // Use AppDispatch type
  const { data } = useSelector((state: RootState) => state.healthRecords)
  
  return <div>{/* Component JSX */}</div>
}
```

## ğŸ—ï¸ Component Structure
```typescript
// âœ… Standard component structure
const ComponentName: React.FC<Props> = ({ prop1, prop2 }) => {
  // 1. Hooks at the top
  const [state, setState] = useState()
  const dispatch = useDispatch<AppDispatch>()
  const { user } = useAuth()
  
  // 2. Event handlers
  const handleClick = () => {
    // Implementation
  }
  
  // 3. Effects
  useEffect(() => {
    // Side effects
  }, [])
  
  // 4. Render
  return (
    <div>
      {/* JSX */}
    </div>
  )
}
```

## ğŸ’¬ Comments & Documentation
- **Korean Comments**: Use Korean for all comments and documentation
- **Clear Descriptions**: Keep comments clear and descriptive
- **Business Logic**: Document complex business logic
- **JSDoc**: Use JSDoc for function documentation

```typescript
/**
 * ê±´ê°• ê¸°ë¡ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
 * @param userId ì‚¬ìš©ì ID
 * @returns ê±´ê°• ê¸°ë¡ ë°°ì—´
 */
const fetchUserHealthRecords = async (userId: string): Promise<HealthRecord[]> => {
  // êµ¬í˜„ ë‚´ìš©
}
```

## ğŸš« Common Mistakes to Avoid

### Type Import Errors
- âŒ **NEVER** import types without `type` keyword
  ```typescript
  import { AppDispatch } from '../store'  // âŒ Runtime error!
  import { PayloadAction } from '@reduxjs/toolkit'  // âŒ Runtime error!
  ```
- âœ… **ALWAYS** use `type` keyword for type-only imports
  ```typescript
  import type { AppDispatch } from '../store'  // âœ… Correct
  import type { PayloadAction } from '@reduxjs/toolkit'  // âœ… Correct
  ```

### General TypeScript Errors
- âŒ Don't use `any` type
- âŒ Don't ignore TypeScript errors
- âŒ Don't use `@ts-ignore` without good reason
- âŒ Don't mix interface and type for the same concept
- âœ… Always use explicit return types for functions
- âœ… Always handle null/undefined cases

### Import Organization
- âŒ Don't mix value and type imports in the same statement
- âœ… Separate value imports from type imports
- âœ… Group imports by category (React, third-party, internal, types)

### Import Completeness & Error Prevention
- âœ… **ALWAYS** import all used components, functions, and types
- âœ… **ALWAYS** verify imports before using them in JSX or code
- âœ… **ALWAYS** use consistent import naming (aliases)
- âŒ **NEVER** use undefined variables or components
- âŒ **NEVER** forget to import Material-UI icons

```typescript
// âœ… Correct: All used icons are imported
import {
  Add as AddIcon,
  Delete as DeleteIcon,
  Edit as EditIcon,
  Settings as SettingsIcon,
} from '@mui/icons-material'

// âŒ Wrong: Using DeleteIcon without importing it
<Button startIcon={<DeleteIcon />}>Delete</Button>  // ReferenceError!
```

### Material-UI Icon Import Checklist
Before using any Material-UI icon, ensure it's imported:
1. **Check the import statement** - Is the icon imported from `@mui/icons-material`?
2. **Verify the alias** - Is the icon properly aliased (e.g., `Delete as DeleteIcon`)?
3. **Test the usage** - Does the icon render without errors?
4. **Check for typos** - Is the icon name spelled correctly?

### Common Import Errors to Avoid
- âŒ **Missing icon imports**: `DeleteIcon is not defined`
- âŒ **Missing component imports**: `Button is not defined`
- âŒ **Missing type imports**: `AppDispatch is not defined`
- âŒ **Wrong import path**: `Cannot resolve module`
- âŒ **Circular imports**: `Circular dependency detected`